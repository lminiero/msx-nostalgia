2 KEYOFF:KEY1,"HELP"+CHR$(13):KEY2,"LOAD ^":KEY3,"CLS"+CHR$(13):KEY4,"KFUN ":KEY5,"OPER"+CHR$(13)
3 KEY6,"TLIST"+CHR$(13):KEY7,"COLOR ":KEY8,"KLIST"+CHR$(13):KEY9,"BACK"+CHR$(13):KEY10,"EXIT"+CHR$(13):KEYON
4 CLS:WIDTH40:SCREEN0:COLOR14,1,1:N$="?! Order error":PRINT"MSX-UTILITY machine language"
5 PRINT"Version 1.0 (c) 1993"
6 PRINT"UTILITY PROGRAM 1"
7 PRINT"by ML-Soft"
8 FORQWERT=1TO432:NEXTQWERT
9 PRINT:PRINT"  Type <HELP> if you don't know how  to do something"
10 PRINT"       <EXIT> to return to MSX BASIC"
11 PRINT:PRINT"Press <CAPS> key"
12 GOSUB997
13 IFA$="CLS"THENA=1ELSEGOTO14
14 IFA$="TLIST"THENA=2ELSEGOTO15
15 IFA$="KLIST"THENA=3ELSEGOTO16
16 IFA$="BACK"THENA=4ELSEGOTO17
17 IFA$="OPER"THENA=5ELSEGOTO18
18 WE$=LEFT$(A$,4):IFWE$="KFUN"THENA=6ELSEGOTO19
19 NO$=LEFT$(A$,5):IFNO$="COLOR"THENA=7ELSEGOTO20
20 IFLEFT$(A$,6)="LOAD ^"THENA=8ELSEGOTO21
21 IFA$="EXIT"THENA=9ELSEGOTO22
22 IFLEFT$(A$,3)="CRT"THENA=10ELSEGOTO23
23 IFLEFT$(A$,5)="ASCII"THENA=11ELSEGOTO24
24 IFLEFT$(A$,9)="ASCLOAD ^"THENA=12ELSEGOTO25
25 IFLEFT$(A$,8)="MGLOAD ^"THENA=13ELSEGOTO26
26 IFLEFT$(A$,9)="BASLOAD ^"THENA=14
100 IFA=4THENGOTO980
101 ONAGOSUB993,990,987,980,900,971,958,943,936,982,933,800,810,820
102 IFA=0THENGOTO103ELSEGOTO104
103 PRINT:PRINTN$:PRINT:GOTO12
104 GOTO12
800 ' ASCLOAD
801 L=LEN(A$):IFL>15ORL<8THENGOTO802ELSEGOTO803
802 PRINT:PRINTN$:PRINT:RETURN
803 NA$=MID$(A$,10,6)
804 KEYOFF:CLS:COLOR 15,4,4:BLOAD"CAS:"+NA$,R
810 ' MGLOAD
811 L=LEN(A$):IFL>14ORL<7THENGOTO812ELSEGOTO813
812 PRINT:PRINTN$:PRINT:RETURN
813 NA$=MID$(A$,9,6)
814 MERGE"CAS:"+NA$
820 ' BASLOAD
821 L=LEN(A$):IFL>15ORL<8THENGOTO822ELSEGOTO823
822 PRINT:PRINTN$:PRINT:RETURN
823 NA$=MID$(A$,10,6)
824 KEYOFF:CLS:COLOR 15,4,4:CLOADNA$
850 ' ADD
851 INPUT"First number ";W
852 INPUT"Second number ";Q
853 R=Q+W:G=0:GOTO909
854 ' SOTT
855 INPUT"First number ";W
856 INPUT"Second number ";Q
857 R=W-Q:G=0:GOTO909
858 ' DIVIS
859 INPUT"First number ";W
860 INPUT"Second number ";Q:IFQ=0THENPRINT"Error-Division by zero"ANDGOTO910ELSEGOTO861
861 R=W/Q:G=0:GOTO909
862 ' MOLT
863 INPUT"First number ";W
864 INPUT"Second number ";Q
865 R=W*Q:G=0:GOTO909
866 ' RADQ
867 ONERRORGOTO911
868 INPUT"Number ";Q
869 R=SQR(Q):G=0:GOTO909
870 ' POT
871 INPUT"Base ";W
872 INPUT"Exponent ";Q
873 R=W^Q:G=0:GOTO909
874 ' BIN
875 INPUT"Number ";W:IFW>65535!ORW<-32768!THEN875
876 R$=BIN$(W):G=1
877 GOTO909
878 ' OTT
879 INPUT"Number ";W:IFW>65535!ORW<-32768!THEN879
880 R$=OCT$(W):G=1
881 GOTO909
882 ' ESAD
883 INPUT"Number ";W:IFW>65535!ORW<-32768!THEN883
884 R$=HEX$(W):G=1
885 GOTO909
886 ' LOG
887 ONERRORGOTO890:INPUT"Number ";W
888 R=LOG(W):G=0
889 GOTO909
890 IFERR=5ANDERL=888THENPRINT"Error":GOTO909
900 ' OPER
901 PRINT"Choose:"
902 PRINT"1. Addition        6. Power"
903 PRINT"2. Subtraction     7. Bynary code"
904 PRINT"3. Division        8. Octonary code"
905 PRINT"4. Multiplication  9. Hexadecimal code"
906 PRINT"5. Square root    10. Natural logarithm"
907 INPUTT$:T=VAL(T$):IFT<1ORT>10THEN907
908 ONTGOTO850,854,858,862,866,870,874,878,882,886
909 IFG=1THEN912ELSEGOTO910
910 PRINTR:RETURN
911 IFERR=11ANDERL=869THENPRINT"Error":RETURN
912 PRINTR$:RETURN
933 ' ASCII
934 L=LEN(A$):IFL<>7THENGOTO812ELSEGOTO935
935 C$=MID$(A$,7,1):PRINT:PRINTASC(C$):PRINT:RETURN
936 ' EXIT
937 INPUT"Are you sure (Y/N) ";S$
938 IFS$="y"ORS$="Y"THEN939ELSERETURN
939 CLS:COLOR 15,4,4
940 KEY1,"color ":KEY2,"auto ":KEY3,"goto ":KEY4,"list ":KEY5,"run"+CHR$(13)
941 KEY6,"color 15,4,4"+CHR$(13):KEY7,"cload"+CHR$(34):KEY8,"cont"+CHR$(13):KEY9,"list."+CHR$(13):KEY10,"run"+CHR$(13)+CHR$(11)
942 END
943 ' LOAD
944 L=LEN(A$):IFL>12ORL<5THENGOTO945ELSEGOTO946
945 PRINT:PRINTN$:PRINT:RETURN
946 NA$=MID$(A$,7,6)
947 KEYOFF:CLS:COLOR 15,4,4:LOAD"CAS:"+NA$,R
958 ' COLOR
959 L=LEN(A$):IFL>10ORL<9THEN960ELSE961
961 IFL=9THENGOTO962ELSEGOTO966
962 CC$=MID$(A$,9,1):CC=VAL(CC$)
963 WW$=MID$(A$,7,1):IFWW$<>"B"THENGOTO968ELSEGOTO964
964 COLOR,CC,CC:RETURN
965 COLORCC:RETURN
966 CC$=MID$(A$,9,2):CC=VAL(CC$):IFCC>15THENGOTO960
967 GOTO963
968 IFWW$="C"THENGOTO965ELSE969
969 GOTO960
971 ' KFUN
972 L=LEN(A$):IFL<6ORL>7THENGOTO973ELSEGOTO974
973 PRINT:PRINTN$:PRINT:RETURN
974 IFL=6THENGOTO975ELSEGOTO978
975 K$=RIGHT$(A$,1):K=VAL(K$)
976 INPUTKK$:INPUTIN$:IFIN$="&"THENGOTO977ELSEGOTO978
977 KEYK,KK$+CHR$(13):RETURN
978 KEYK,KK$:RETURN
979 K$=RIGHT$(A$,2):K=VAL(K$):GOTO976
980 ' BACK
981 GOTO 2
982 ' CRT
983 L=LEN(A$):IFL<4ORL>7THENGOTO812ELSEGOTO984
984 F$=MID$(A$,5,3):F=VAL(F$):IFF<0ORF>255THENGOTO812ELSEGOTO985
985 PRINT:PRINTCHR$(F):PRINT
986 RETURN
987 ' KLIST
988 PRINT:KEYLIST:PRINT
989 RETURN
990 ' LIST
991 LIST
992 RETURN
993 ' CLS
994 CLS
995 RETURN
996 ' A>
997 A$="":A=0
998 LINEINPUT"A>";A$
999 RETURN
