1 ' SUB
5 ' INIZIALIZZAZIONE
7 CLEAR:INTERVALON:KEYOFF:SCREEN0:COLOR4,1,1:WIDTH40
10 PRINT"      ЫЫЫЫЫ     Ы    Ы     ЫЫЫЫЫЫ"
11 PRINT"     Ы          Ы    Ы     Ы     Ы"
12 PRINT"     Ы          Ы    Ы     Ы     Ы"
13 PRINT"      ЫЫЫЫ      Ы    Ы     ЫЫЫЫЫЫ"
14 PRINT"          Ы     Ы    Ы     Ы     Ы"
15 PRINT"          Ы     Ы    Ы     Ы     Ы"
16 PRINT"     ЫЫЫЫЫ       ЫЫЫЫ      ЫЫЫЫЫЫ"
17 LOCATE1,20:PRINT"Premi un tasto per iniziare..."
18 A$=INKEY$:IFA$=""THEN18
19 A$=""
20 CLS:PRINT" Sei il miglior agente della squadra    U.A.F.(Underwater American Force)       e il tuo compito Љ di recuperare i      tesori sparsi sul fondo marino.          Pensi sia facile?"
21 PRINT" Sappi che il territorio che stai per   esplorare Љ territorio nemico per       cui dovrai vedertela con i SUB nemici.   In pi— dovrai difenterti dagli squali  presenti e da alcune piovre.             Degli altri pesci che vedrai non ti"
22 PRINT"preoccupare.                             Non dimenticare che per entrare nella  grotta avrai bisogno di una torcia, che dovrai trovare sul fondo poichЉ l'hai   persa i una precedente escursione in    queste acque."
23 PRINT:PRINT:PRINT" BUONA FORTUNA!!!!!"
24 IFINKEY$=""THEN24
25 PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT"     NOTTE/GIORNO?"
26 UI$=INKEY$:IFUI$=""THEN26
27 IFUI$<>"N"ANDUI$<>"G"ANDUI$<>"n"ANDUI$<>"g"THEN26
28 IFUI$="N"ORUI$="n"THENU=1ELSEIFUI$="G"ORUI$="g"THENU=7
50 SCREEN2,2:GOSUB60000
51 A=STICK(0):STRIG(0)ON:B=STRIG(0):SPRITEON:ONSPRITEGOSUB53000:ONSTRIGGOSUB54000:COLOR,U,1
52 ' *************************
53 ' *  DISEGNO     SCHERMI  *
54 ' *************************
55 PT=6:T=0:O=100:P=0:N=15:S=10:E=3:X=50:Y=128
56 ONINTERVAL=100GOSUB59998
57 OPEN"grp:"FOROUTPUTAS#1
1000 ' A1
1001 AP=1:AN=1:XA=70:YA=140:PS=18:NP=0:PI=0:SP=1:XS=158:YS=96:COLOR,U,1:L=1
1002 LINE(1,90)-(255,159),4,BF
1003 COLOR6:DRAW"BM0,30F10D5M30,70M31,90F30M67,160D32":PAINT(1,147),6:LINE(20,105)-(40,130),7,BF:COLOR1:PSET(21,105),1:PRINT#1,"UAF"
1004 GOSUB52000:GOSUB55000
1005 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
1006 PUTSPRITE1,(XS,YS),1,PS
1007 GOSUB55100
1008 PUTSPRITE2,(XA,YA),6,NA
1009 GOSUB51000
1013 GOTO 1004
2000 ' B1
2001 AP=0:SP=0:NP=0:PI=0:COLOR,U,1:L=2
2002 LINE(1,90)-(255,159),4,BF
2003 GOSUB52000:GOSUB55000
2004 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
2005 GOSUB55100
2006 GOSUB51000
2007 GOTO 2003
3000 ' C1
3001 AP=0:SP=0:NP=0:PI=0:COLOR,U,1:L=3
3002 LINE(1,90)-(255,159),4,BF
3003 GOSUB52000:GOSUB55000
3004 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
3005 GOSUB55100
3006 GOSUB51000
3007 GOTO 3003
4000 ' D1
4001 AP=0:SP=0:NP=0:PI=0:COLOR,U,1:L=4
4002 LINE(1,90)-(255,159),4,BF
4003 GOSUB52000:GOSUB55000
4004 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
4005 GOSUB55100
4006 GOSUB51000
4007 GOTO 4003
5000 ' E1
5001 AP=0:SP=0:NP=0:PI=0:COLOR,U,1:L=5
5002 LINE(1,90)-(255,159),4,BF
5003 GOSUB52000:GOSUB55000
5004 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
5005 GOSUB55100
5006 GOSUB51000
5007 GOTO 5003
6000 ' F1
6001 AP=0:SP=0:NP=0:PI=0:COLOR,U,1:L=6
6002 LINE(1,90)-(255,159),4,BF
6003 GOSUB52000:GOSUB55000
6004 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
6005 GOSUB55100
6006 GOSUB51000
6007 GOTO 6003
10000 ' C2
10001 AP=1:AN=1:XA=70:YA=140:SP=0:NP=0:PI=0:COLOR,4,4:L=10
10002 GOSUB52000:GOSUB55000
10003 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
10004 GOSUB55100
10005 PUTSPRITE2,(XA,YA),6,NA
10006 GOSUB51000
10007 GOTO10002
12000 ' E2
12001 AP=1:AN=5:XA=70:YA=140:SP=0:NP=0:PI=0:COLOR,4,4:L=12
12002 GOSUB52000:GOSUB55000
12003 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
12004 GOSUB55100
12005 PUTSPRITE2,(XA,YA),6,NA
12006 GOSUB51000
12007 GOTO12002
13000 ' F2
13001 AP=1:AN=2:XA=70:YA=140:SP=0:NP=0:PI=0:COLOR,4,4:L=13
13002 GOSUB52000:GOSUB55000
13003 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
13004 GOSUB55100
13005 PUTSPRITE2,(XA,YA),6,NA
13006 GOSUB51000
13007 GOTO13002
17000 ' C3
17001 AP=1:AN=1:XA=70:YA=140:SP=0:NP=0:PI=0:COLOR,4,4:L=17
17002 GOSUB52000:GOSUB55000
17003 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
17004 GOSUB55100
17005 PUTSPRITE2,(XA,YA),6,NA
17006 GOSUB51000
17007 GOTO17002
20000 ' F3
20001 AP=1:AN=1:XA=70:YA=140:SP=0:NP=0:PI=0:COLOR,4,4:L=20
20002 GOSUB52000:GOSUB55000
20003 GOSUB50000:PUTSPRITE0,(X,Y),1,PT
20004 GOSUB55100
20005 PUTSPRITE2,(XA,YA),6,NA
20006 GOSUB51000
20007 GOTO20002
50000 ' MOVIMENTO SUB
50001 A=STICK(0):IFA=0THEN50100ELSEIFA=1THENGOTO50009
50002 IFA=2THENGOTO50010
50003 IFA=3THENGOTO50011
50004 IFA=4THENGOTO50012
50005 IFA=5THENGOTO50013
50006 IFA=6THENGOTO50014
50007 IFA=7THENGOTO50015
50008 IFA=8THENGOTO50016
50009 Y=Y-2:GOTO50100
50010 X=X+2:Y=Y-2:PT=6:GOTO50100
50011 X=X+2:PT=6:GOTO50100
50012 X=X+2:Y=Y+2:PT=6:GOTO50100
50013 Y=Y+2:GOTO50100
50014 X=X-2:Y=Y+2:PT=10:GOTO50100
50015 X=X-2:PT=10:GOTO50100
50016 X=X-2:Y=Y-2:PT=10:GOTO50100
50100 ' MOVIMENTO ANIMALI EVENT. PRESENTI
50101 IFAP=1THEN50102ELSE50200
50102 IFAN=1ORAN=3THENXA=XA+1ELSE50103
50103 IFAN=4THENXA=XA
50104 IFAN=5ORAN=2THENXA=XA+2
50106 IFAN=1THENNA=14
50107 IFAN=2THENNA=2
50108 IFAN=3THENNA=1
50109 IFAN=4THENNA=0
50110 IFAN=5THENNA=17
50200 ' MOVIMENTO ANIMALI NEMICI
50201 IFSP>0THEN50202ELSE50250
50202 OX=X-XS:OY=Y-YS
50203 IFOX>0THEN50204ELSEIFOX<0THEN50205ELSE50206
50204 XS=XS+4:PS=19:GOTO50206
50205 XS=XS-4:PS=18
50206 IFOY>4THEN50207ELSEIFOY<-4THEN50208ELSE50250
50207 YS=YS+4:GOTO50249
50208 YS=YS-4
50249 ' **** PIOVRA ****
50250 IFPI>0THEN50251ELSE50300
50251 LX=X-XP:LY=Y-YP
50252 IFLX>0THEN50254ELSEIFLX<0THEN50255ELSEIFLX=0THEN50256
50254 XP=XP+3:GOTO50256
50255 XP=XP-3
50256 IFLY>4THEN50257ELSEIFLY<-4THEN50258ELSE50300
50257 YP=YP-3:GOTO50300
50258 YP=YP+3
50299 ' **** NEMICI ****
50300 IFNP>0THEN50301ELSERETURN
50301 NK=X-XN:NH=Y-YN
50302 IFNK>0THEN50303ELSEIFNK<0THEN50304ELSEIFNK=0THEN50305
50303 XN=XN+2:PN=7:GOTO50305
50304 XN=XN-2:PN=11
50305 IFNH>4THEN50306ELSEIFNH<-4THEN50307ELSE50700
50306 YN=YN+2:RETURN
50307 YN=YN-2:RETURN
51000 ' * USCITA DALLO SCHERMO VISIVO *
51001 IFX>255THEN51005
51002 IFX<0THEN51050
51003 IFY>160THEN51100
51004 IFY<90THEN51150ELSERETURN
51005 IFL<>7ANDL<>14ANDL<>21ANDL<>28ANDL<>35ANDL<>42ANDL<>45ANDL<>32THEN51006ELSE51007
51006 X=1:L=L+1:GOTO51020
51007 IFL=7ORL=14ORL=21ORL=28THEN51008ELSE51009
51008 X=255:RETURN
51009 IFL=42ANDY>128ANDY<160ANDX>255THEN51010ELSEIFX>255ANDY<128THEN51019ELSE51011
51010 L=35:X=240:Y=144:GOTO51020
51011 IFL=45ANDY>135ANDY<160ANDX>255THEN51012ELSEIFX>255ANDY<135THEN51019ELSE51013
51012 L=32:X=245:Y=147:GOTO51020
51013 IFL=35ANDY>128ANDY<160ANDX>255THEN51014ELSEIFX>255ANDY<128THEN51019ELSE51015
51014 L=42:X=240:Y=144:GOTO51020
51015 IFL=32ANDY>135ANDY<160ANDX>255THEN51016ELSEIFX>255ANDY<135THEN51019
51016 L=45:X=245:Y=147:GOTO51020
51019 X=255:RETURN
51020 GOTO 52000
51050 IFL<>1ANDL<>8ANDL<>15ANDL<>22ANDL<>29ANDL<>36THEN51051ELSE51052
51051 L=L-1:X=245:GOTO52000
51052 IFL=1ORL=8ORL=15ORL=22THEN51053ELSE51054
51053 X=0:RETURN
51054 IFL=29ANDX<0ANDY<160ANDY>128THEN51055ELSEIFX<0ANDX<128THEN51053ELSE51056
51055 L=36:X=10:Y=144:GOTO52000
51056 IFL=36ANDX<0ANDY>128ANDY<160THEN51057ELSEIFX<0ANDY<128THEN51058ELSE52000
51057 L=29:X=10:Y=144:GOTO52000
51058 X=0:GOTO52000
52000 ' **** QUADRATO DI PUNTEGGIO ****
52001 LINE(0,160)-(255,191),1,BF
52002 RETURN
53000 ' * SOVRAPPOSIZIONE SPRITE$ *
53001 IFOX<8ANDOX>-8ANDOY<8ANDOY>-8ORLX<8ANDLX>-8ANDLY>-8ANDLY<8ORNK>-8ANDNK<8ANDNH<8ANDNH>-8THENGOSUB53500ELSEGOTO53002
53002 IFX-TOX<8ANDX-TOX>-8ANDY-TOY>-8ANDY-TOY<8THENT=1ELSEGOTO53004
53004 RETURN
53500 ' ***** MORTE SUB *****
53501 E=E-1:FORI=1TO15:COLOR,,I:NEXTI:RETURN
54000 PRINT"CIAO!!!":RETURN
55000 COLOR15:O$=STR$(O)
55001 PSET(10,163),15:PRINT#1,"Ossigeno:";O$;"%"
55002 PSET(10,173),15:PRINT#1,"Punti:";P
55003 PSET(10,183),15:PRINT#1,"Vite:";E
55004 RETURN
55100 ' *** OSSIGENO 0 % ***
55101 IFO=0THEN55102ELSERETURN
55102 O=100:GOSUB53500:RETURN
59997 ' *** OSSIGENO ***
59998 O=O-1
59999 RETURN
60000 ' CORALLI
60001 B$="":FORI=1TO8
60002 READA$:B$=B$+CHR$(VAL("&H"+A$))
60003 NEXTI:SPRITE$(0)=B$:SPRITE$(20)=B$:SPRITE$(21)=B$:SPRITE$(22)=B$:SPRITE$(23)=B$:SPRITE$(24)=B$
60004 DATA10,50,5A,32,94,58,30,10
60005 ' TARTARUGA
60006 B$="":FORI=1TO8
60007 READA$:B$=B$+CHR$(VAL("&H"+A$))
60008 NEXTI:SPRITE$(1)=B$
60009 DATA0,0,0,0,1C,BE,7F,21
60010 ' PESCE
60011 B$="":FORI=1TO8:READA$
60012 B$=B$+CHR$(VAL("&H"+A$))
60013 NEXTI:SPRITE$(2)=B$
60014 DATA0,8,19,7F,FF,1,0,0
60015 ' FIOCINA
60016 B$="":FORI=1TO8:READA$
60017 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60018 SPRITE$(3)=B$
60019 DATA0,0,0,6,F8,6,0,0
60020 ' OSSIGENO
60021 B$="":FORI=1TO8:READA$
60022 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60023 SPRITE$(4)=B$
60024 DATA18,18,18,18,18,18,18,18
60025 ' TESORO
60026 B$="":FORI=1TO8:READA$
60027 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60028 SPRITE$(5)=B$
60029 DATA0,0,0,0,BD,7E,5A,7E
60030 ' SUB E NEMICO NORMALI(DESTRA)
60031 B$="":FORI=1TO8:READA$
60032 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60033 C$="":FORI=1TO8:READA$
60034 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60035 D$="":FORI=1TO8:READA$
60036 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60037 E$="":FORI=1TO8:READA$
60038 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60039 SPRITE$(6)=B$+C$+D$+E$
60040 SPRITE$(7)=SPRITE$(6)
60041 DATA0,0,0,0,0,3,E7,1F
60042 DATAFF,0,0,0,0,0,0,0
60043 DATA0,0,0,0,0,D8,FC,F1
60044 DATAF6,1D,0,0,0,0,0,0
60045 ' SUB E NEMICO SENZA FIOCINA(DESTRA)
60046 D$="":FORI=1TO8:READA$
60047 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60048 E$="":FORI=1TO8:READA$
60049 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60050 SPRITE$(8)=B$+C$+D$+E$
60051 SPRITE$(9)=SPRITE$(8)
60052 DATA0,0,0,0,0,D8,FC,F0
60053 DATAF6,1C,0,0,0,0,0,0
60054 ' SUB E NEMICO NORMALE(SINISTRA)
60055 B$="":FORI=1TO8:READA$
60056 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60057 C$="":FORI=1TO8:READA$
60058 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60059 D$="":FORI=1TO8:READA$
60060 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60061 E$="":FORI=1TO8:READA$
60062 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60063 SPRITE$(10)=B$+C$+D$+E$
60064 SPRITE$(11)=SPRITE$(10)
60065 DATA0,0,0,0,0,1B,3F,8F
60066 DATA6F,B8,0,0,0,0,0,0
60067 DATA0,0,0,0,0,C0,E7,F8
60068 DATAFF,0,0,0,0,0,0,0
60069 ' SUB E NEMICO SENZA FIOCINA(SINISTRA)
60070 B$="":C$="":FORI=1TO8:READA$
60071 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60072 FORI=1TO8:READA$
60073 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60074 SPRITE$(12)=B$+C$+D$+E$
60075 SPRITE$(13)=SPRITE$(12)
60076 DATA0,0,0,0,0,1B,3F,0F
60077 DATABF,38,0,0,0,0,0,0
60078 ' BRANCO DI PESCIOLINI
60079 B$="":C$="":D$="":E$=""
60080 FORI=1TO8:READA$:B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60081 C$=B$:D$=B$:E$=B$
60082 SPRITE$(14)=B$+C$+D$+E$
60083 DATA20,15,80,0A,50,02,50,01
60084 ' PIOVRA
60085 B$="":C$="":D$="":E$=""
60086 FORI=1TO8:READA$
60087 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60088 FORI=1TO8:READA$
60089 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60090 FORI=1TO8:READA$
60091 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60092 FORI=1TO8:READA$
60093 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60094 SPRITE$(15)=B$+C$+D$+E$
60095 DATA07,0A,0F,0F,3F,5F,AF,4A
60096 DATA92,11,11,21,21,21,01,0
60097 DATA0,80,80,80,F0,CF,A0,90
60098 DATA48,44,42,21,20,20,0,0
60099 ' TESORO DELLA STIVA
60100 B$="":C$="":D$="":E$=""
60101 FORI=1TO8:READA$
60102 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60103 FORI=1TO8:READA$
60104 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60105 FORI=1TO8:READA$
60106 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60107 FORI=1TO8:READA$
60108 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60109 SPRITE$(16)=B$+C$+D$+E$
60110 DATA0,0,0,0,7F,40,40,4F
60111 DATA5A,75,EA,7F,7F,7F,7F,7F
60112 DATA0,0,0,0,FE,E2,E2,F2
60113 DATAAA,56,5B,FE,FE,FE,FE,FE
60114 ' MURENA
60115 B$="":C$="":D$="":E$=""
60116 FORI=1TO8:READA$
60117 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60118 FORI=1TO8:READA$
60119 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60120 FORI=1TO8:READA$
60121 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60122 FORI=1TO8:READA$
60123 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60124 SPRITE$(17)=B$+C$+D$+E$
60125 DATA0,0,0,C0,47,78,0,0
60126 DATA0,0,0,0,0,0,0,0
60127 DATA0,0,0,0,1C,E3,0,0
60128 DATA0,0,0,0,0,0,0,0
60129 ' SQUALO SINISTRA
60130 B$="":C$="":D$="":E$=""
60131 FORI=1TO8:READA$
60132 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60133 FORI=1TO8:READA$
60134 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60135 FORI=1TO8:READA$
60136 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60137 FORI=1TO8:READA$
60138 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60139 SPRITE$(18)=B$+C$+D$+E$
60140 DATA0,0,0,0,0,0,0,01
60141 DATA3F,5F,FF,0,0,0,0,0
60142 DATA0,0,0,0,0,40,C1,C3
60143 DATAFF,FF,FF,01,0,0,0,0
60144 ' SQUALO DESTRA
60145 B$="":C$="":D$="":E$=""
60146 FORI=1TO8:READA$
60147 B$=B$+CHR$(VAL("&H"+A$)):NEXTI
60148 FORI=1TO8:READA$
60149 C$=C$+CHR$(VAL("&H"+A$)):NEXTI
60150 FORI=1TO8:READA$
60151 D$=D$+CHR$(VAL("&H"+A$)):NEXTI
60152 FORI=1TO8:READA$
60153 E$=E$+CHR$(VAL("&H"+A$)):NEXTI
60154 SPRITE$(19)=B$+C$+D$+E$
60155 DATA0,0,0,0,0,02,83,C3
60156 DATAFF,FF,FF,80,0,0,0,0
60157 DATA0,0,0,0,0,0,0,80
60158 DATAFC,FA,FF,0,0,0,0,0
60159 ' TORCIA
60160 B$="":FORI=1TO8:READA$
60161 B$=B$+CHR$(VAL("&H"+A$)):NEXTI:SPRITE$(25)=B$
60162 DATA0,0,0,2,3C,2,0,0
60163 RETURN
